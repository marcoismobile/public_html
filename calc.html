
<html>
    <head>
        <title>Calculator</title>

<script>
function calcPositionSize()
{
    // Get values from form
    var f = document.forms["calculator"];
    var equity = parseFloat(f.elements["equity"].value);
    var risk = parseFloat(f.elements["risk"].value);
    var entry = parseFloat(f.elements["entry"].value);
    var target = parseFloat(f.elements["take_profit"].value);
    var stop = parseFloat(f.elements["stop_loss"].value);

    // Calculate max loss
    var stopCost = equity * risk / 100;

    if (f.elements["type"].value == 1)
    {
        // LONG POSITION
        var positionSize = stopCost / (entry - stop);
        var targetGain = positionSize * (target - entry);
    } else {
        // SHORT POSITION
        var positionSize = stopCost / (stop - entry);
        var targetGain = positionSize * (entry - target);
    }

    // Calculate Risk Reward rate
    var rrRatio = targetGain / stopCost;

    // Calculate leverage
    var leverage = positionSize * entry / equity

	var result = "POSITION:\t$" + roundNumber(positionSize * entry, 2 ) + " (BASE: " + roundNumber(positionSize, 9) + ") [" + roundNumber(leverage, 2) + "x]<br>" +
           "LOSS:\t\t$" + roundNumber(stopCost, 5) + "<br>" +
           "PROFIT:\t\t$" + roundNumber(targetGain, 5) + "<br>" +
           "RR:\t\t\t" + roundNumber(rrRatio, 2) + "x";
    
    var result = "<table>" +
                "<tr><td>POSITION:</td><td>$ " + roundNumber(positionSize * entry, 2 ) + " (BASE: " + roundNumber(positionSize, 9) + ") [" + roundNumber(leverage, 2) + "x]</td></tr>" +
                "<tr><td>PROFIT:</td><td>$ " + roundNumber(targetGain, 5) + "</td></tr>" +
                "<tr><td>LOSS:</td><td>$ " + roundNumber(stopCost, 5) + "</td></tr>" +
                "<tr><td>RR:</td><td>" + roundNumber(rrRatio, 2) + "x</td></tr>"
                "</table>"
    
    // Show result
    document.getElementById('result').innerHTML = result;

    // Change text color according to RR ratio
    var textColor;
    if (rrRatio <= 1) {
        textColor = 'red';
    } else if (rrRatio <= 3) {
        textColor = 'orange';
    } else {
        textColor = 'green';
    }
    var tds = document.getElementsByTagName("td");
    for(var i = 0, j = tds.length; i < j; ++i)
        tds[i].style.color = textColor;

}

function roundNumber(number, precision){
    precision = Math.abs(parseInt(precision)) || 0;
    var multiplier = Math.pow(10, precision);
    return (Math.round(number * multiplier) / multiplier);
}

</script>

    </head>
    <body>
		<form id="calculator" method="post" action="" onsubmit="return false;">
            <table>
                <tr>
                    <td>Equity:</td><td><input id="equity" type="text" size="8" value=""> $</td>
                </tr>
                <tr>
                    <td>Risk:</td><td><input id="risk" type="text" size="3" value="1"> %</td>
                </tr>
                <tr>
                    <td>Type:</td>
                    <td>
                        <select id="type"> 
                            <option value="1" selected="selected">Long</option>
                            <option value="2">Short</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Entry:</td><td><input id="entry" type="text" size="8" value=""> $</td>
                </tr>
                <tr>
                    <td>Take Profit:</td><td><input id="take_profit" type="text" size="8" value=""> $</td>
                </tr>
                <tr>
                    <td>Stop Loss:</td><td><input id="stop_loss" type="text" size="8" value=""> $</td>
                </tr>
                <tr>
                    <td colspan="2"><input type="submit" value="Calculate" onclick="calcPositionSize()"></td>
                </tr>
            </table>
		</form>	
		<div id="result"></div>
    </body>
</html>